#!/usr/bin/python3
import os
import sys

prestr=""
poststr=""
use_real_path = False
use_quotation = False
replace_doller = False


def traversal_path(replace_dir,path):
    '''
    遍历文件夹，返回一个列表，列表中存放所有遍历出的文件的全路径
    '''
    real_path = path  # 绝对路径
    path = path.replace(replace_dir,"") # 相对路径
    if not os.path.isdir(real_path):
        # 如果这不是一个文件夹，是个文件 , 直接打印
        if use_real_path:
            path = os.path.join("" , os.getcwd()+path)
        if use_quotation:
            path = "\"{}\"".format(path)
        if replace_doller:
            path = path.replace("$",r"\$") # 传递给file命令时不处理$符号
        print(prestr + path + poststr)
        return 
    # 如果这是一个文件夹
    for file_name in os.listdir(real_path): # 递归查找
        try:
            traversal_path(replace_dir,os.path.join(real_path,file_name))
        except PermissionError:
            continue
    # 最后通过列表返回所有的文件内容

if __name__ == "__main__":
    if len(sys.argv) > 1:
        # if len(sys.argv) != 5:
        #     print("usage : generate [prestr] [poststr] [0|1] [0|1] ")
        #     exit(0)
        prestr = sys.argv[1]
        poststr = sys.argv[2]
        if sys.argv[3] == "1":
            use_real_path = True
        if sys.argv[4] == "1":
            use_quotation = True
        if "doller" in sys.argv:
            replace_doller = True

    traversal_path(os.getcwd(),os.getcwd())
